(()=>{var e={799:()=>{jQuery(document).ready((e=>{"use strict";const t=e(".eac-chart");t.length&&void 0===window.Chart?console.warn("Chart is not available. Make sure to include Chart.js library."):t.each((function(){const t=e(this),a=t.data("datasets"),n=t.data("type")||"line",o=t.data("currency")||"";void 0!==a?new window.Chart(t[0].getContext("2d"),{type:n,data:a,options:{tooltips:{displayColors:!0,YrPadding:12,backgroundColor:"#000000",bodyFontColor:"#e5e5e5",bodySpacing:4,intersect:0,mode:"nearest",position:"nearest",titleFontColor:"#ffffff",callbacks:{label(e,t){let a=t.datasets[e.datasetIndex].data[e.index];const n=t.datasets[e.datasetIndex].label||"";return void 0!==a&&void 0!==n||(a=0),n+": "+Number(a).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+o}}},scales:{xAxes:[{stacked:!1,gridLines:{display:!0}}],yAxes:[{stacked:!1,ticks:{beginAtZero:!0,callback:(e,t,a)=>Number(e).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")+o},type:"linear",barPercentage:.4}]},responsive:!0,maintainAspectRatio:!1,legend:{display:!1}}}):console.warn("Chart datasets is not available.")}))})),document.addEventListener("alpine:init",(()=>{console.log("Alpine.js initialized 2")}))},345:()=>{jQuery(document).ready((e=>{}))},587:()=>{jQuery(document).ready((e=>{}))},247:()=>{jQuery(document).ready((e=>{"use strict";e.eac_exporter=function(t,a){this.defaults={},this.form=t,this.$form=e(t),this.$submit=e('input[type="submit"]',this.$form),this.options=e.extend(this.defaults,a),this.action="eac_ajax_export",this.nonce=this.$form.data("nonce"),this.type=this.$form.data("type");const n=this;return this.submit=function(e){if(e.preventDefault(),n.$submit.hasClass("disabled"))return!1;n.$submit.addClass("disabled"),n.reset(),n.$submit.parent("p").append('<span class="spinner is-active"></span>'),n.$form.append('<div class="eac-progress"><div></div></div>'),n.process_step(1)},this.process_step=function(e){window.wp.ajax.send(n.action,{data:{_wpnonce:n.nonce,type:n.type,step:e},success(e){if("done"===e.step)return n.reset(),n.$form.append('<div class="notice updated"><p>'+e.message+"</p></div></div>"),window.location=e.url,!1;n.$form.find(".eac-progress div").animate({width:e.percentage+"%"},50,(function(){})),n.process_step(parseInt(e.step,10))},error(e){n.reset(),e.message&&n.$form.append('<div class="notice error"><p>'+e.message+"</p></div>"),console.warn(e)}})},this.reset=function(){e(".notice",n.$form).remove(),e(".eac-progress",n.$form).remove(),n.$submit.removeClass("disabled"),e(".spinner",n.$form).remove()},this.$form.on("submit",this.submit),this},e.fn.eac_exporter=function(t){return this.each((function(){new e.eac_exporter(this,t)}))},e("form.eac_exporter").eac_exporter()}))},976:()=>{jQuery(document).ready((e=>{"use strict";e.eac_importer=function(t){this.$form=t,this.$submit=e('input[type="submit"]',this.$form),this.$progress=e('<div class="eac-progress"><div></div></div>'),this.$spinner=e('<span class="spinner is-active" style="float: none"></span>'),this.$notice=e('<div class="notice is-dismissible"><p></p></div>'),this.nonce=this.$form.data("nonce"),this.type=this.$form.data("type"),this.file=null,this.imported=0,this.failed=0,this.updated=0,this.skipped=0;const a=this;this.submit=function(t){if(t.preventDefault(),a.$submit.hasClass("disabled"))return!1;a.reset(),a.$submit.attr("disabled","disabled"),a.$form.append(a.$spinner),a.$form.append(a.$progress);const n=new FormData;n.append("upload",e('input[type="file"]',a.$form)[0].files[0]),n.append("action","eac_upload_import_file"),n.append("_wpnonce",a.nonce),window.wp.ajax.send({type:"POST",data:n,dataType:"json",cache:!1,contentType:!1,processData:!1,success:t=>{t.file?(e('input[type="file"]',a.$form).val(""),a.file=t.file,a.import(0)):t.message&&a.error(t)},error:e=>{a.error(e)}})},this.import=function(e){const t={action:"eac_ajax_import",_wpnonce:a.nonce,file:a.file,type:a.type,position:e};window.wp.ajax.send({type:"POST",data:t,dataType:"json",success:e=>{if("done"===e.position)return a.reset(),void a.$form.append('<div class="notice updated"><p>'+e.message+"</p></div></div>");a.$form.find(".eac-progress div").animate({width:e.percentage+"%"},50),a.import(parseInt(e.position,10))},error:e=>{a.error(e)}})},this.reset=function(){e(".notice",a.$form).remove(),e(".eac-progress",a.$form).remove(),e(".spinner",a.$form).remove(),a.$submit.removeClass("disabled"),a.$submit.removeAttr("disabled")},this.error=function(e){a.reset(),e.message&&(a.$form.append(a.$notice),a.$notice.addClass("notice-error"),a.$notice.find("p").text(e.message))},this.$form.on("submit",this.submit)},e.fn.eac_importer=function(){return this.each((function(){return new e.eac_importer(e(this)),this}))},e("form.eac_importer").eac_importer()}))},361:()=>{jQuery(document).ready((e=>{}))},31:()=>{jQuery(document).ready((e=>{"use strict";const t=e("body");t.on("click","input#eac_business_logo",(function(t){t.preventDefault();const a=e(this),n=wp.media({multiple:!1,library:{type:"image"}});n.on("select",(function(){const e=n.state().get("selection").first().toJSON();a.val(e.url)})),n.open()})),e(".ea-financial-start").datepicker({dateFormat:"dd-mm"}),e(".eac-exchange-rates").on("click","a.add",(function(t){t.preventDefault(),e(this).closest("table").find("tbody").append(e(this).data("row"))})).on("change","select",(function(t){t.preventDefault(),e(this).closest("tr").find("input, select").each((function(){const a=e(this);a.attr("name",a.attr("name").replace(/\[.*\]/,"["+t.target.value+"]"))}))})).on("click","a.remove",(function(t){t.preventDefault(),e(this).closest("tr").remove()})),t.on("change, blur",'input[name^="eac_exchange_rates["]',(function(){e(this).val(parseFloat(e(this).val()).toFixed(4))}))}))},660:()=>{jQuery(document).ready((e=>{}))},711:()=>{jQuery(document).ready((e=>{}))}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,a),s.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.eac.money;var t=a.n(e);jQuery(document).ready((e=>{const a=function(){e(".eac_select2").filter(":not(.enhanced)").each((function(){const t=e(this),a={allowClear:t.data("allow-clear")&&!t.prop("multiple")||!0,placeholder:t.data("placeholder")||"",width:"100%",minimumInputLength:t.data("minimum-input-length")||0,readOnly:t.data("readonly")||!1,ajax:{url:eac_admin_vars.ajax_url,dataType:"json",delay:250,method:"POST",data:e=>({term:e.term,action:t.data("action"),type:t.data("type"),subtype:t.data("subtype"),_wpnonce:eac_admin_vars.search_nonce,exclude:t.data("exclude"),include:t.data("include"),limit:t.data("limit")}),processResults:e=>(e.page=e.page||1,e),cache:!0}};t.data("action")||delete a.ajax,t.addClass("enhanced").selectWoo(a)})),e(".eac_datepicker").filter(":not(.enhanced)").each((function(){const t=e(this),a={dateFormat:t.data("format")||"yy-mm-dd",changeMonth:!0,changeYear:!0,showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0,yearRange:"-100:+10"};t.addClass("enhanced").datepicker(a)})),e(".eac_tooltip").filter(":not(.enhanced)").each((function(){e(this).addClass("enhanced").tooltip({position:{my:"center bottom-15",at:"center top"},tooltipClass:"eac_tooltip"})})),e(":input.eac_amount").filter(":not(.enhanced)").each((function(){const a=e(this),n=a.closest("form").find(a.data("source"));a.inputmask({...t().getCurrencyMaskOptions(a.data("currency"))}).addClass("enhanced"),n.length&&n.on("change",(function(){const o="currency"===e(this).attr("name")?n.val():n.select2("data")?.[0]?.currency;a.inputmask("option",t().getCurrencyMaskOptions(o)),a.data("currency",o)}))})),e(":input.eac_exchange_rate").filter(":not(.enhanced)").each((function(){const a=e(this),n=a.closest("form").find(a.data("source"));a.inputmask({...t().getExchangeRateMaskOptions(a.data("currency"))}).addClass("enhanced").attr("readonly",a.data("currency")===eac_base_currency),n.length&&n.on("change",(function(){const o="currency"===e(this).attr("name")?n.val():n.select2("data")?.[0]?.currency;a.inputmask("option",t().getExchangeRateMaskOptions(o)),a.inputmask("setvalue",t().getRate(o)),a.attr("readonly",o===eac_base_currency)}))})),e(".eac_inputmask").filter(":not(.enhanced)").each((function(){const t=e(this),a={alias:t.data("alias")||"decimal",rightAlign:!1,allowMinus:!1,placeholder:t.data("placeholder")||"",clearIncomplete:t.data("clear-incomplete")||!1,removeMaskOnSubmit:!0};t.addClass("enhanced").inputmask(a)})),e(".eac-card").each((function(){e(this).children('[class*="eac-card__"]').length||parseInt(e(this).css("padding"))||e(this).css("padding","8px 12px")})),e(".eac-card__body").each((function(){e(this).text().trim().length||0!==e(this).children().length||e(this).remove()}))};a(),e(document.body).on("eac_update_ui",a),e(".eac-file-upload").filter(":not(.enhanced)").each((function(){const t=e(this),a=t.find(".eac-file-upload__button"),n=t.find(".eac-file-upload__value"),o=t.find(".eac-file-upload__icon img"),s=t.find(".eac-file-upload__name a"),i=t.find(".eac-file-upload__size"),c=t.find("a.eac-file-upload__remove");a.on("click",(function(e){e.preventDefault();const r=wp.media({title:a.data("uploader-title"),multiple:!1});r.on("ready",(function(){r.uploader.options.uploader.params={type:"eac_file"}})),r.on("select",(function(){const e=r.state().get("selection").first().toJSON(),a="image"===e.type?e.url:e.icon;n.val(e.id),o.attr("src",a).show(),o.attr("alt",e.filename),s.text(e.filename).attr("href",e.url),i.text(e.filesizeHumanReadable),c.show(),t.addClass("has--file")})),r.open()})),c.on("click",(function(e){e.preventDefault(),t.removeClass("has--file"),n.val(""),o.attr("src","").hide(),s.text("").attr("href",""),i.text("")}))})),e(".del_confirm").on("click",(function(e){if(!confirm(eac_admin_vars.i18n.confirm_delete))return e.preventDefault(),!1})),e(document.body).on("keydown","#eac-note",(function(t){13===t.keyCode&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),e("#eac-add-note").click())})).on("click","#eac-add-note",(function(t){t.preventDefault();const a=e(this),n=e("#eac-note"),o=e(".eac-notes"),s={action:"eac_add_note",nonce:a.data("nonce"),parent_id:a.data("parent_id"),parent_type:a.data("parent_type"),content:n.val()};s.content&&(a.prop("disabled",!0),e.ajax({type:"POST",url:eac_admin_vars.ajax_url,data:s,success(e){let t=wpAjax.parseAjaxResponse(e);t=t.responses[0],o.prepend(t.data),n.val(""),a.prop("disabled",!1),o.find(".no-items").hide()}}).fail((function(){a.prop("disabled",!1)})))})).on("click",".eac-notes .note__delete",(function(t){t.preventDefault();const a=e(this),n=a.closest(".note"),o=n.closest(".eac-notes"),s={action:"eac_delete_note",nonce:a.data("nonce"),note_id:a.data("note_id")};confirm(eac_admin_vars.i18n.confirm_delete)&&e.ajax({type:"POST",url:eac_admin_vars.ajax_url,data:s,success(e){"1"===e&&(console.log(e),n.remove()),0===o.find("li").length&&o.find(".no-items").show()}})})),e(".eac_print_document").on("click",(function(t){t.preventDefault();const a=e(e(this).data("target"));console.log(a),a.length&&a.printThis({printContainer:!0,printDelay:0,header:null,footer:null})})),e(".eac_share_document").on("click",(function(t){t.preventDefault();const a=e(this).data("url");if(!a)return;const n=e("<input>");e("body").append(n),n.val(a).select(),document.execCommand("copy"),n.remove(),window.prompt(eac_admin_vars.i18n.share_prompt,a)&&window.open(a,"_blank")})),e.fn.block=function(t){return this.each((function(){const a=e(this);t&&a.find(".blockUI").length?a.find(".blockUI").remove():a.find(".blockUI").length||("static"===a.css("position")&&a.css("position","relative"),e('<div class="blockUI"></div>').css({position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgb(255, 255, 255)",opacity:.1,cursor:"wait",zIndex:9999}).appendTo(a))}))}})),a(31);const n=window.wp.apiFetch;var o=a.n(n);jQuery(document).ready((e=>{e("#eac-edit-bill").eac_form({events:{'change :input[name="contact_id"]':"onChangeContact",'change :input[name="currency"]':"onChangeCurrency","select2:select .add-item":"onAddItem","click .remove-item":"onRemoveItem","change .item-price, .item-quantity":"onChangeItem","select2:select .item-taxes":"onAddTax","select2:unselect .item-taxes":"onRemoveTax",'change :input[name="discount_type"], :input[name="discount_value"]':"onChangeDiscount"},onChangeContact(t){const a=this,n=a.getValues();delete n.eac_action,n.action="eac_get_bill_address",a.block(),console.log(n),console.log(ajaxurl),e.post(ajaxurl,n,(function(e){a.unblock();const t=wpAjax.parseAjaxResponse(e,"data");t&&!t.errors?a.$(".document-address").html(t.responses[0].data):a.$(".document-address").html("")}))},onChangeCurrency(e){this.updateTotals()},onAddItem(t){const a=this,n=t.params.data,s=_.uniqueId();a.block(),e(t.target).val(null).trigger("change");const i=a.$(':input[name="exchange_rate"]').inputmask("unmaskedvalue")||1;o()({path:"eac/v1/items/"+n.id}).then((function(e){const t={};t["items["+s+"][item_id]"]=e.id,t["items["+s+"][name]"]=e.name,t["items["+s+"][description]"]=e.description,t["items["+s+"][price]"]=(e.cost||e.price)*i,t["items["+s+"][quantity]"]=1,t["items["+s+"][type]"]=e.type,t["items["+s+"][unit]"]=e.unit,e.taxes&&(e.taxes.forEach((function(e){const a=_.uniqueId();t["items["+s+"][taxes]["+a+"][tax_id]"]=e.id,t["items["+s+"][taxes]["+a+"][name]"]=e.name,t["items["+s+"][taxes]["+a+"][rate]"]=e.rate,t["items["+s+"][taxes]["+a+"][compound]"]=e.compound||!1})),a.updateTotals(t))}))},onRemoveItem(t){e(t.target).closest("tr").remove(),this.updateTotals()},onChangeItem(e){this.updateTotals()},onAddTax(t){const a=t.params.data,n=e(t.target).closest("tr").data("index"),o=_.uniqueId(),s={...this.getValues(),["items["+n+"][taxes]["+o+"][tax_id]"]:a.id,["items["+n+"][taxes]["+o+"][name]"]:a.name,["items["+n+"][taxes]["+o+"][rate]"]:a.rate,["items["+n+"][taxes]["+o+"][compound]"]:a?.compound};this.updateTotals(s)},onRemoveTax(t){const a=this,n=a.getValues(),o=t.params.data,s=e(t.target).closest("tr"),i=s.data("index");for(const e in n){const t=e.match(/^items\[(\d+)\]\[taxes\]\[(\d+)\]\[tax_id\]$/);t&&t[1]===i.toString()&&n[e]===o.id.toString()&&s.find(`input[name^="items[${i}][taxes][${t[2]}]"]`).remove()}setTimeout((function(){a.$(t.target).select2("close"),a.updateTotals()}),0)},onChangeDiscount(e){this.updateTotals()},updateTotals(t){const a=this;t={...this.getValues(),...t||{},action:"eac_get_recalculated_bill"},a.block();const n=document.activeElement;e.post(ajaxurl,t,(function(t){const n=wpAjax.parseAjaxResponse(t);n&&!n.errors&&(a.$(".eac-document-items__items").html(n.responses[0].data),a.$(".eac-document-items__totals").html(n.responses[1].data),e(document.body).trigger("eac_update_ui"))})).always((function(){a.unblock(),n.focus()}))}}),e(".eac-add-bill-payment").on("click",(function(a){a.preventDefault();const n=e(this),s=n.data("id");n.prop("disabled",!0),o()({path:"eac/v1/bills/"+s}).then((function(a){n.eacmodal({template:"eac-bill-payment",events:{'change :input[name="account_id"]':"onChangeAccount",'change :input[name="exchange_rate"]':"onChangeExchangeRate",submit:"onSubmit"},onChangeAccount(a){const n=e(a.target).closest("form"),o=(e(a.target).select2("data")?.[0]||{}).currency||eac_base_currency;n.find(':input[name="exchange_rate"]').val(t().getRate(o)).removeClass("enhanced").data("currency",o).attr("readonly",o===eac_base_currency).trigger("change"),n.find(':input[name="amount"]').removeClass("enhanced").data("currency",o),e(document.body).trigger("eac_update_ui")},onChangeExchangeRate(n){const o=e(n.target).closest("form").find(':input[name="amount"]'),s=parseFloat(e(n.target).val());o.val(t().convert(a.due_amount,a.currency,s))},onSubmit(e){e.preventDefault();const t=this,a=t.getValues();o()({path:"eac/v1/expenses",method:"POST",data:{...a,editable:!1}}).then((function(){t.close(),location.reload()})).catch((function(e){e.message?alert(e.message):alert("Something went wrong. Please try again.")}))}})})).finally((function(){n.prop("disabled",!1)}))}))})),a(345),a(587),jQuery(document).ready((e=>{e("#eac-edit-invoice").eac_form({events:{'change :input[name="contact_id"]':"onChangeContact",'change :input[name="currency"]':"onChangeCurrency","select2:select .add-item":"onAddItem","click .remove-item":"onRemoveItem","change .item-price, .item-quantity":"onChangeItem","select2:select .item-taxes":"onAddTax","select2:unselect .item-taxes":"onRemoveTax",'change :input[name="discount_type"], :input[name="discount_value"]':"onChangeDiscount"},onChangeContact(t){const a=this,n=a.getValues();delete n.eac_action,n.action="eac_get_invoice_address",a.block(),e.post(ajaxurl,n,(function(e){a.unblock();const t=wpAjax.parseAjaxResponse(e,"data");t&&!t.errors?a.$(".document-address").html(t.responses[0].data):a.$(".document-address").html("")}))},onChangeCurrency(){this.updateTotals()},onAddItem(t){const a=this,n=t.params.data,s=_.uniqueId();a.block(),e(t.target).val(null).trigger("change");const i=a.$(':input[name="exchange_rate"]').inputmask("unmaskedvalue")||1;o()({path:"eac/v1/items/"+n.id}).then((function(e){const t={};t["items["+s+"][item_id]"]=e.id,t["items["+s+"][name]"]=e.name,t["items["+s+"][description]"]=e.description,t["items["+s+"][price]"]=(e.price||e.cost)*i,t["items["+s+"][quantity]"]=1,t["items["+s+"][type]"]=e.type,t["items["+s+"][unit]"]=e.unit,e.taxes&&(e.taxes.forEach((function(e){const a=_.uniqueId();t["items["+s+"][taxes]["+a+"][tax_id]"]=e.id,t["items["+s+"][taxes]["+a+"][name]"]=e.name,t["items["+s+"][taxes]["+a+"][rate]"]=e.rate,t["items["+s+"][taxes]["+a+"][compound]"]=e.compound||!1})),a.updateTotals(t))}))},onRemoveItem(t){e(t.target).closest("tr").remove(),this.updateTotals()},onChangeItem(e){this.updateTotals()},onAddTax(t){const a=t.params.data,n=e(t.target).closest("tr").data("index"),o=_.uniqueId(),s={...this.getValues(),["items["+n+"][taxes]["+o+"][tax_id]"]:a.id,["items["+n+"][taxes]["+o+"][name]"]:a.name,["items["+n+"][taxes]["+o+"][rate]"]:a.rate,["items["+n+"][taxes]["+o+"][compound]"]:a?.compound};this.updateTotals(s)},onRemoveTax(t){const a=this,n=a.getValues(),o=t.params.data,s=e(t.target).closest("tr"),i=s.data("index");for(const e in n){const t=e.match(/^items\[(\d+)\]\[taxes\]\[(\d+)\]\[tax_id\]$/);t&&t[1]===i.toString()&&n[e]===o.id.toString()&&s.find(`input[name^="items[${i}][taxes][${t[2]}]"]`).remove()}setTimeout((function(){a.$(t.target).select2("close"),a.updateTotals()}),0)},onChangeDiscount(e){this.updateTotals()},updateTotals(t){const a=this;t={...this.getValues(),...t||{},action:"eac_get_recalculated_invoice"},a.block();const n=document.activeElement;e.post(ajaxurl,t,(function(t){const o=wpAjax.parseAjaxResponse(t);o&&!o.errors&&(a.$(".eac-document-items__items").html(o.responses[0].data),a.$(".eac-document-items__totals").html(o.responses[1].data),a.unblock(),e(document.body).trigger("eac_update_ui"),n.focus())}))}}),e(".eac-add-invoice-payment").on("click",(function(a){a.preventDefault();const n=e(this),s=n.data("id");n.prop("disabled",!0),o()({path:"eac/v1/invoices/"+s}).then((function(a){n.eacmodal({template:"eac-invoice-payment",events:{'change :input[name="account_id"]':"onChangeAccount",'change :input[name="exchange_rate"]':"onChangeExchangeRate",submit:"onSubmit"},onChangeAccount(a){const n=e(a.target).closest("form"),o=(e(a.target).select2("data")?.[0]||{}).currency||eac_base_currency;n.find(':input[name="exchange_rate"]').val(t().getRate(o)).removeClass("enhanced").data("currency",o).attr("readonly",o===eac_base_currency).trigger("change"),n.find(':input[name="amount"]').removeClass("enhanced").data("currency",o),e(document.body).trigger("eac_update_ui")},onChangeExchangeRate(n){const o=e(n.target).closest("form").find(':input[name="amount"]'),s=parseFloat(e(n.target).val());o.val(t().convert(a.due_amount,a.currency,s))},onSubmit(e){e.preventDefault();const t=this,a=t.getValues();o()({path:"eac/v1/payments",method:"POST",data:{...a,editable:!1}}).then((function(){t.close(),location.reload()})).catch((function(e){e.message?alert(e.message):alert("Something went wrong. Please try again.")}))}})})).finally((function(){n.prop("disabled",!1)}))}))})),a(361),a(660),a(711),a(799),a(976),a(247)})()})();